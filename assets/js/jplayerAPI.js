// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    var api;
    api = {
      addBookmark: function(jplayerSelector) {
        var bookmark, jplayer, jplayerContainer, playPercent, popoverContent, timePlayed;
        jplayer = $(jplayerSelector);
        jplayerContainer = jplayer.closest(".jp-container");
        playPercent = jplayer.data("jPlayer").status.currentPercentAbsolute;
        timePlayed = jplayer.data("jPlayer").status.currentTime.toFixed(2);
        bookmark = $("<div class='jp-bookmark' style='left:" + playPercent + "%;'>&nbsp;</div>");
        jplayerContainer.find(".jp-play-bar").append(bookmark);
        popoverContent = $("<div class='jp-bookmark-content' onmouseover=''><div class='add-comment'></div></div>");
        $(bookmark).popover({
          title: timePlayed,
          trigger: 'manual',
          animation: false,
          placement: 'bottom',
          content: popoverContent
        });
        return $(bookmark).combinedHover({
          additionalTriggers: ".popover",
          live: true,
          onTrigger: function() {
            return $(bookmark).popover('show');
          },
          offTrigger: function() {
            return $(bookmark).popover('hide');
          }
        });
      },
      snapshot: function(jplayerSelector) {
        var canvas, ctx, ratio, video;
        video = $(jplayerSelector)[0];
        canvas = $('<canvas></canvas>')[0];
        ratio = 54 / video.videoHeight;
        canvas.width = ratio * video.videoWidth;
        canvas.height = 54;
        ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight, 0, 0, canvas.width, canvas.height);
        return canvas.toDataURL('image/jpeg');
      },
      initAdditionalToolbar: function(jplayerSelector) {
        var additionalSeekBar, jplayer, jplayerContainer;
        jplayer = $(jplayerSelector);
        jplayerContainer = jplayer.closest(".jp-container");
        return additionalSeekBar = jplayerContainer.find(".jp-additional-seek-bar");
      }
    };
    return App.jplayerAPI = api;
  });

}).call(this);
